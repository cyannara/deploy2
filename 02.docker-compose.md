## docker compose <img src ="./images/dockercompose01.png" width="80">

- Docker Compose는 여러 컨테이너를 실행하는 환경을 효율적으로 관리하는 도구
- 도커 테스크톱을 설치할 때 기본적으로 포함돼 있어 별도로 설치하지 않아도 바로 사용할 수 있습니다. 또한 한번의 명령어로 모든 컨테이너, 네트워크, 볼륨을 동시에 생성할 수있으며 전체 환경을 한꺼번에 종료할 수 있습니다.

### docker compose 설치

```sh
# Compose Plugin

sudo mkdir -p /usr/local/lib/docker/cli-plugins/
sudo curl -SL "https://github.com/docker/compose/releases/latest/download/docker-compose-linux-$(uname -m)" -o /usr/local/lib/docker/cli-plugins/docker-compose
sudo chmod +x /usr/local/lib/docker/cli-plugins/docker-compose
```

### [docker compose 명령어](https://docs.docker.com/reference/cli/docker/compose/)

```
docker compose up              <=  YAML 파일에 정의된 서비스 생성 및 시작  ( -d --build  <= 빌드한 후 백그라운드로 실행 )
docker compose ps              <=  현재 실행중인 서비스의 상태 표시
docker compose start           <=  서비스에 대한 기존 컨테이너를 시작
docker compose stop            <=  실행중인 컨테이너를 삭제하지 않고 중지
docker compose logs            <=  실행중인 서비스의 로그 표시
docker compose down            <=  YAML 파일에 정의된 서비스 종료 및 제거
docker compose build           <=  서비스의 도커파일 또는 내용이 변경된 경우 이미지를 다시 빌드
```

### mysql + springboot

docker-compose.yml

```yml
version: "3.8"

services:
  mysql:
    image: mysql:8.0
    container_name: mysql-container
    ports:
      - "3306:3306"
    volumes:
      - vtest:/var/lib/mysql
    environment:
      MYSQL_ROOT_PASSWORD: admin
      MYSQL_DATABASE: edudb
      MYSQL_USER: jdbctest
      MYSQL_PASSWORD: jdbctest
    networks:
      - springboot-mysql-net

  springedu:
    image: cyannara/edu:latest
    container_name: springedu-container
    ports:
      - "81:9090"
    volumes:
      - fileupload-volume:/uploadtest
    depends_on:
      - mysql
    networks:
      - springboot-mysql-net

volumes:
  vtest:
  fileupload-volume:

networks:
  springboot-mysql-net:
    driver: bridge
```

### mysql + redmine
